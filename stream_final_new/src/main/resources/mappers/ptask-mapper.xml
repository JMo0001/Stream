<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="task">
  
	<select id="selectList" resultType="PtaskVo">
		SELECT * 
		FROM TASK
	</select>

	<select id="ProjectSelectOne" resultType="PtaskVo">
		SELECT tno,  pno, userid, tmember, ttitle, tcontent, tstatus
			, to_char(tdate, 'yyyy-mm-dd') tdate
			, to_char(tstartdate, 'yyyy-mm-dd') tstartdate
			, to_char(tenddate, 'yyyy-mm-dd') tenddate
			, bref, brelevel, brestep
		FROM TASK
		WHERE PNO=#{PNO}
	</select>
		
	<select id="ProjectSelectOneInner" resultType="PtaskVo" parameterType="map">
		SELECT tno,  pno, userid, tmember, ttitle, tcontent, tstatus
			, to_char(tdate, 'yyyy-mm-dd') tdate
			, to_char(tstartdate, 'yyyy-mm-dd') tstartdate
			, to_char(tenddate, 'yyyy-mm-dd') tenddate
			, bref, brelevel, brestep 
		FROM TASK
		WHERE PNO=#{pno} and TNO=#{tno}
	</select>	
	
	<insert id="insertTask" parameterType="PtaskVo">
		<selectKey order="BEFORE" keyColumn="ctno" keyProperty="tno" resultType="string">
		select task_sequence.NEXTVAL as ctno from dual
		</selectKey>
		INSERT 
		INTO TASK (TNO, PNO, USERID, TMEMBER, TTITLE, TCONTENT, TSTATUS, tstartdate, tenddate, bref, brelevel, brestep)
			VALUES (#{tno}, #{pno}, #{userid}, #{tmember}, #{ttitle}, #{tcontent}, #{tstatus}, #{tstartdate}, #{tenddate}, #{tno}, '0', '0')
	</insert>

	<delete id="deleteTask" parameterType="PtaskVo">
		DELETE FROM TASK WHERE PNO = #(pno)
  	</delete>

</mapper>
