<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="project">
  
	<select id="selectList" parameterType="String" resultType="ProjectVo">
		SELECT PNO, USERID, PNAME, PCONTENT, PACCESS, PDATE, to_char(PSTARTDATE, 'yyyy-mm-dd') PSTARTDATE, to_char(PENDDATE, 'yyyy-mm-dd') PENDDATE, PSTATUS, DEPTNO, DEPTNAME, MNAME, MRANK, ROWNUM PROW
		FROM (SELECT DEPTNO, DEPTNAME, USERID, MNAME, MRANK FROM USERS JOIN DEPT USING(DEPTNO, CCODE))
		JOIN PROJECT USING(USERID)
		WHERE PSTATUS IN ('미진행', '진행', '보류') AND USERID = #{userid}
		<!-- USERID = #(username) -->
	</select>
	
	<select id="selectHide" resultType="ProjectVo">
		SELECT PNO, USERID, PNAME, PCONTENT, PACCESS, PDATE, to_char(PSTARTDATE, 'yyyy-mm-dd') PSTARTDATE, to_char(PENDDATE, 'yyyy-mm-dd') PENDDATE, PSTATUS, DEPTNO, DEPTNAME, MNAME, MRANK, ROWNUM PROW
		FROM (SELECT DEPTNO, DEPTNAME, USERID, MNAME, MRANK FROM USERS JOIN DEPT USING(DEPTNO, CCODE))
		JOIN PROJECT USING(USERID)
		WHERE PSTATUS IN ('숨김') AND USERID = #{username}
		<!-- USERID = #(username) -->
	</select>
	 
	<select id="selectOne" resultType="ProjectVo">
		SELECT PNO, USERID, PNAME, PCONTENT, PACCESS, PDATE, to_char(PSTARTDATE, 'yyyy-mm-dd') PSTARTDATE, to_char(PENDDATE, 'yyyy-mm-dd') PENDDATE, PSTATUS
		FROM PROJECT
		WHERE PNO = #{pno}
	</select>
	 
	<insert id="insertList" parameterType="ProjectVo">
		INSERT INTO PROJECT (PNO, USERID, PNAME, PCONTENT, PACCESS, PSTARTDATE, PENDDATE, PSTATUS)
		VALUES (project_sequence.NEXTVAL, #{userid}, #{pname}, #{pcontent}, #{paccess}, #{pstartdate}, #{penddate}, #{pstatus})
	</insert>
	 
	<delete id="deleteList" parameterType="ProjectVo">
		DELETE FROM PROJECT WHERE PNO = #(pno) 
	</delete>
	 
	<update id="updateList" parameterType="ProjectVo">
		UPDATE PROJECT SET PNAME=#{pname}, pcontent=#{pcontent}, PSTATUS=#{pstatus}, PSTARTDATE=#{pstartdate}, PENDDATE=#{penddate}
		WHERE PNO=#{pno}
	</update>
	
</mapper>
